<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.css">
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

  <style>
    /* Styles for the DataTables */
    body {
      padding: 0 10%;
      font-family: Arial, sans-serif;
    }

    #myTable_wrapper {
      width: 100%;
      margin: 0 auto;
    }

    .dataTables_wrapper .dataTables_filter {
      float: right;
      text-align: right;
    }

    .dataTables_wrapper .dataTables_filter input {
      margin-left: 0.5em;
    }

    th,
    td {
      text-align: center;
      padding: 15px;
      border-bottom: 1px solid #ddd;
    }

    th {
      background-color: #007BFF;
      color: white;
    }

    tr:nth-child(even) {
      background-color: #f2f2f2;
    }

    tr:hover {
      background-color: #ddd;
    }

    /* Styles for the sticky footer */
    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .footer {
      margin-top: auto;
      padding: 1em;
      background-color: #f5f5f5;
      text-align: center;
    }

    .footer a {
      margin: 0 1em;
      text-decoration: none;
      color: #007BFF;
    }
  </style>

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>
</head>

<body>
  <table id="productTable" class="display">
    <thead>
      <tr>
        <th>Product</th>
        <th>Website</th>
        <th>Company</th>
        <th>Categories</th>
        <th>Created</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>

  <div class="footer">
    <a href="https://twitter.com/yourusername" target="_blank">Twitter</a>
    <a href="https://facebook.com/yourusername" target="_blank">Facebook</a>
    <a href="https://instagram.com/yourusername" target="_blank">Instagram</a>
    <a href="https://linkedin.com/in/yourusername" target="_blank">LinkedIn</a>
  </div>

  <!-- Firebase App is always required -->
  <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>

  <!-- If you enabled Firestore -->
  <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-firestore.js"></script>


  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDDlkdT8uTRiInLEvIpbwBrcQr2W8Qxrjg",
      authDomain: "ai-products-fyi.firebaseapp.com",
      projectId: "ai-products-fyi",
      storageBucket: "ai-products-fyi.appspot.com",
      messagingSenderId: "200912904917",
      appId: "1:200912904917:web:20d0b0228d1701f6a6785c",
      measurementId: "G-1NJ9427M8Q"
    };

    firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();

    $(document).ready(function () {
      // Setup DataTable with custom rendering for the 4th and 1st columns
      var table = $('#productTable').DataTable({
        columnDefs: [
          // {
          //   targets: 4,
          //   render: function (data) {
          //     var date = new Date(data + '-01-01');
          //     return date.getFullYear();
          //   }
          // },
          {
            targets: 1,
            render: function (data) {
              return `<a href="${data}" target="_blank">${data}</a>`;
            }
          }
        ]
      });

      // Get a reference to the "products" collection
      var productsRef = db.collection("products");

      // Get all documents in the collection
      productsRef.get().then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
          // Get the data from Firestore
          var docData = doc.data();

          // Add the data to the DataTable
          table.row.add([
            docData.Product,
            docData.Website,
            docData.Company,
            docData.Categories,
            docData.Created,
          ]);
        });

        // Redraw the table now that the data has been added
        table.draw();
      });

      // Setup custom search function
      $.fn.dataTable.ext.search.push(
        function (settings, data, dataIndex) {
          var searchTerm = $('.dataTables_filter input').val().toLowerCase();
          var rowData = data.map(value => value.toLowerCase()); // convert row data to lower case

          // return true if row data contains exact search term, false otherwise
          return rowData.some(value => value.includes(searchTerm));
        }
      );

      // Redraw the table when the search input changes
      $('.dataTables_filter input').on('keyup', function () {
        table.draw();
      });
    });
  </script>
</body>

</html>